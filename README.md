# Loop Fission Benchmarks

This repository is for benchmarking the loop fission algorithm presented in _"TBD"_.

This is a curated benchmark suite. The included benchmarks have been selected specifically for 
offering opportunity to perform loop fission transformation. 

All programs are written in C language. Both `for` and `while` loop programs are included. 
For each benchmark we measure difference in clock time, after loop fission and parallelization using 
[OpenMP](https://www.openmp.org/) directives, compared to original baseline version. 

We compare results of our technique to an alternative technique, generated by 
[ROSE compiler](http://rosecompiler.org/).

## Benchmark directory organization

| Directory  | Description                                                     |
|:-----------|:----------------------------------------------------------------|
| `original` | baseline, unmodified programs                                   | 
| `fission`  | transformed and parallelized programs, using our method         |
| `alt`      | transformed and parallelized programs, using alternative method |

## Benchmark descriptions

| Benchmark | Loop kind | Description                                                 |
|-----------|:---------:|-------------------------------------------------------------|
| `3mm`     |  `while`  | 3D matrix multiplication, from PolyBench/C                  | 
| `bicg`    |  `while`  | BiCG sub kernel of BiCGStab linear solver, from PolyBench/C | 
| `deriche` |  `while`  | Edge detection filter, from PolyBench/C                     | 
| `fdtd-2d` |  `while`  | 2-D finite different time domain kernel, from PolyBench/C   | 
| `gesummv` |  `while`  | Scalar, vector and matrix multiplication, from PolyBench/C  | 
| `mvt`     |  `while`  | Matrix vector product and transpose, from PolyBench/C       | 

## Other directories and files

* `headers/` header files for benchmark programs.

* `utilities/` e.g. the benchmarking timing script `utilities/time_benchmark.sh`. 
   These utilities are directly extended from  
   [PolyBench/C benchmark suite](http://web.cse.ohio-state.edu/~pouchet.2/software/polybench/), 
   [version 4.2](https://sourceforge.net/projects/polybench/files/).

* `run.sh` is a wrapper for the timing script; it enables benchmarking directories (not just single programs).

* `script_autopar.sh` is used for inserting automatic parallelization directives. 
  
* `plot.py` is used for generating tables and plots from results.

The folders `results` and `plots` are discussed below.


## Running the benchmarks

Running benchmarks will compile and time the execution of specified programs.
The results will be written into `results/` directory. 

Run all benchmarks:

```text
make all
```

- Compatible with Linux/OS X hosts.
- System should include a C compiler that supports OpenMP pragmas (assumes GCC).
- You may specify an alternative compiler, using `make all CC=compiler_here`.

For more customizable execution options, call the `run.sh` script directly, with choice of arguments: 
       
```text
./run.sh 
```

**Available arguments**

| FLAG | DESCRIPTION: options                                                      | DEFAULT     |
|:----:|:--------------------------------------------------------------------------|:------------|
| `-c` | system compiler to use                                                    | `gcc`       |
| `-d` | which directory:  `original`, `fission`, `alt`                            | `original`  | 
| `-o` | optimization level: `O0`, `O1`, `O2`, `O3`, ...                           | `O0`        |
| `-v` | max. variance (%) when timing results: > `0.0`                            | `5.0`       |
| `-s` | data size: `MINI`, `SMALL`, `MEDIUM`, `LARGE`, `EXTRALARGE`, `STANDARD`   | `STANDARD`  |
| `-p` | benchmark specific program: `3mm`, `bicg`, `deriche` ...                  | _not set_   |

If necessary, change permissions: `chmod u+r+x ./run.sh`.


