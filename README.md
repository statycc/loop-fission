# Loop Fission Benchmarks

This repository is for benchmarking the loop fission algorithm presented in _"TBD"_.

This is a curated benchmark suite. The included benchmarks have been selected specifically 
for offering opportunity to perform loop fission transformation. For each benchmark, we measure 
difference in clock time, after loop fission and parallelization using [OpenMP](https://www.openmp.org/).

We compare the original baseline programs to those generated by our loop fission technique.
We also compare our technique to an alternative loop fission technique used in the
[ROSE compiler](http://rosecompiler.org/).

## Benchmark directory organization

| Directory  | Description                                                     |
|:-----------|:----------------------------------------------------------------|
| `original` | baseline, unmodified programs                                   | 
| `fission`  | transformed and parallelized programs, using our method         |
| `alt`      | transformed and parallelized programs, using alternative method |

## Benchmark descriptions

All programs are written in C language. We include programs with both `for` and `while` loops. 

| Benchmark  | Description                               | Origin            | for | while |
|------------|-------------------------------------------|-------------------|:---:|:-----:|
| `3mm`      | 3D matrix multiplication                  | [PolyBench/C][PB] |     |   ✔   | 
| `bicg`     | BiCG sub kernel of BiCGStab linear solver | [PolyBench/C][PB] |     |   ✔   | 
| `colormap` | Type conversion of photometric palette    | [MiBench][MB]     |  ✔  |       | 
| `deriche`  | Edge detection filter                     | [PolyBench/C][PB] |     |   ✔   | 
| `fdtd-2d`  | 2-D finite different time domain kernel   | [PolyBench/C][PB] |     |   ✔   | 
| `gesummv`  | Scalar, vector and matrix multiplication  | [PolyBench/C][PB] |     |   ✔   | 
| `mvt`      | Matrix vector product and transpose       | [PolyBench/C][PB] |     |   ✔   | 

## Other directories and files

* `headers/` header files for benchmark programs.

* `utilities/` e.g. the benchmarking timing script. These utilities are directly extended from
   [PolyBench/C benchmark suite][PB], 
   [version 4.2](https://sourceforge.net/projects/polybench/files/).

* `run.sh` is a wrapper for the timing script; it enables benchmarking directories.

* `script_autopar.sh` is used for inserting automatic parallelization directives. 
  
* `plot.py` is used for generating tables and plots from results.

The folders `results` and `plots` are discussed below.


## Running the benchmarks

Compiles and times the execution of programs. The results will be written into `results/` directory. 

**Run all benchmarks**

```text
make all
```

- Compatible with Linux/OS X hosts.
- System should include a C compiler that supports OpenMP pragmas (assumes GCC).
- You may specify an alternative compiler using `make all CC=compiler_here`.

For more customizable execution options, call the `run.sh` script directly: 
       
```text
./run.sh 
```

**Available arguments**

| FLAG | DESCRIPTION: options                                                      | DEFAULT     |
|:----:|:--------------------------------------------------------------------------|:------------|
| `-c` | system compiler to use                                                    | `gcc`       |
| `-d` | which directory:  `original`, `fission`, `alt`                            | `original`  | 
| `-o` | optimization level: `O0`, `O1`, `O2`, `O3`, ...                           | `O0`        |
| `-v` | max. variance (%) when timing results: > `0.0`                            | `5.0`       |
| `-s` | data size: `MINI`, `SMALL`, `MEDIUM`, `LARGE`, `EXTRALARGE`, `STANDARD`   | `STANDARD`  |
| `-p` | benchmark specific program: `3mm`, `bicg`, `deriche` ...                  | _not set_   |

If necessary, change permissions: `chmod u+r+x ./run.sh`.

[PB]: http://web.cse.ohio-state.edu/~pouchet.2/software/polybench/
[MB]: https://vhosts.eecs.umich.edu/mibench